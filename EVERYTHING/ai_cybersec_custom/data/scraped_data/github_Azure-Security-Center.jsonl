{"source": "github", "repo": "Azure/Azure-Security-Center", "file": ".github/ISSUE_TEMPLATE/bug_report.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/.github/ISSUE_TEMPLATE/bug_report.md", "content": "---\nname: Bug report\nabout: Create a report to help us improve\ntitle: ''\nlabels: ''\nassignees: ''\n\n---\n\n**Describe the bug**\nA clear and concise description of what the bug is. Make sure to [reference the automation artifact](https://docs.github.com/en/github/managing-your-work-on-github/opening-an-issue-from-code) or code this bug relates to.\n\n**To Reproduce**\nSteps to reproduce the behavior:\n\n1. Go to '...'\n2. Click on '....'\n3. Scroll down to '....'\n4. See error\n\n**Expected behavior**\nA clear and concise description of what you expected to happen.\n\n**Additional context**\nAdd any other context about the problem here.", "timestamp": "2025-10-21T22:03:52.027161"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": ".github/ISSUE_TEMPLATE/feature_request.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/.github/ISSUE_TEMPLATE/feature_request.md", "content": "---\nname: Feature request\nabout: Suggest an idea for this project\ntitle: ''\nlabels: ''\nassignees: ''\n\n---\n\n**Is your feature request related to a problem? Please describe.**\nA clear and concise description of what the problem is. Ex. I'm always frustrated when [...], I'm looking for [...]\n\n**Describe the solution you'd like**\nA clear and concise description of what you want to happen.\n\n**Describe alternatives you've considered**\nA clear and concise description of any alternative solutions or features you've considered.\n\n**Additional context**\nAdd any other context or screenshots about the feature request here.", "timestamp": "2025-10-21T22:03:52.128377"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": ".script/ReadMe.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/.script/ReadMe.md", "content": "# How to add new PR validation\n\nAt the time of submitting your Pull Request, automatic GitHub validations using Azure Pipelines is enabled on this repository for basic syntactical checks of the contributions. You can add custom tests as needed based on your scenario following this guidance.\n\n## What is Azure Pipelines  \n\n[Azure Pipelines](https://docs.microsoft.com/en-us/azure/devops/pipelines/get-started/what-is-azure-pipelines?view=azure-devops) is a cloud service that you can use to automatically build and test your code project and make it available to other users. It works with just about any language or project type.   \n\n\n## How to add new PR validation:\n1. Install the following extensions, if you use [VS Code](https://code.visualstudio.com/docs/azure/extensions) editor: \n   - [Azure Pipelines](https://marketplace.visualstudio.com/items?itemName=ms-azure-devops.azure-pipelines)\n   - [Yaml](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml)\n\n2. Run \"npm install\" cmd, in order to install the libraries used in this project.  \nThe libraries are defined in package.json\n\n3. Create an Azure Pipeline job for the new validation.  \nAdd new yaml file under [.azure-pipelines](https://github.com/Azure/Azure-Sentinel/blob/master/.azure-pipelines/) folder, see example in [yamlFileValidator.yaml](https://github.com/Azure/Azure-Sentinel/blob/master/.azure-pipelines/yamlFileValidator.yaml) file (note - the script code should be added on another file for clearer code, see in step #5). \n    * Add scripts those are relevant to the specific folder under one yaml file in the same job. The validation infrastructure and the examples are in TypeScript, but you can use other languages if you prefer\n    * Azure Pipelines work with many languages such as Python, Java,JavaScript, PHP, Ruby, C#, C++, and Go. Refer to [Azure Pipelines documentation](https://docs.microsoft.com/en-us/azure/devops/pipelines/?view=azure-devops) for further information on this. \n\n4. Add the new job to [azure-pipelines.yml](https://github.com/Azure/Azure-Sentinel/blob/master/azure-pipelines.yml) file as a new template under jobs property\n\n5. Create script file for the new validation. The job from step #3 has reference to this file. See instructions in [How to add script validation](#how-to-add-script-validation) section.  \n   A step is a failure if it either explicitly reports failure (using a ##vso command) or ends the script with a non-zero exit code\n\n6. Test the new validation. See instruction in [How to test the new validation](#How-to-test-the-new-validation) section\n\n### How to add script validation\n\n**Note**: All script logs are public and display in DevOps pipeline.  \nBy default, the logs color is white. In case you want another color you can use [logging commands](https://docs.microsoft.com/en-us/azure/devops/pipelines/scripts/logging-commands?view=azure-devops&tabs=bash)\n\n1. Create script file under [.script](https://github.com/Azure/Azure-Sentinel/tree/master/.script) folder\n\n2. In case you use TypeScript language, you can use the infrastructure script. See example in [yamlFileValidator.ts](https://github.com/Azure/Azure-Sentinel/blob/master/.script/yamlFileValidator.ts):\n   - Create async validation function that gets file path and returns success in case the validation pass.\n   - Create CheckOptions object with 3 properties:  \n     - onCheckFile: the validation function that will run on each file (from step one)  \n     - onExecError: error behavior in case that the file validation failed  \n     - onFinalFailed:  error behavior at the end of the validation, execute in case one of the validation failed\n   - Call runCheckOverChangedFiles with properties:\n     - checkOptions:  the object you create in the earlier step 2  \n     - fileTypeSuffixes : file type filter, example: [\"yaml\", \"yml\"]\n     - filePathFolderPreffixes: folder path filter, example: [\"Detections\"]\n   - Run prettier command to fix type script files format.  \n     - install \"npm install -g prettier\" if needed\n     - Run cmd: prettier --write --print-width 200 \".script/**/*.ts\"\n\n### How to test the new validation\n\n1. In case the language script is TypeScript, check the new validation function by local tests. Since most of the code are the same, these tests will help you validate your changes before it gets merged to master.  \nSee example in [yamlFileValidatorTest](https://github.com/Azure/Azure-Sentinel/tree/master/.script/tests/yamlFileValidatorTest) folder.\n\n   - Create new folder under [.script/test](https://github.com/Azure/Azure-Sentinel/tree/master/.script/tests). folder name format: TestedFileName+Test  \n   - Create tests file. File name format: TestedFileName.test.ts  \n   - Run the test by execute from  cmd \"npm test\".  \nSince it is run locally you will see \"Azure DevOps CI for a Pull Request wasn't found. If issue persists - please open an issue\" message. You can ignore it.\n   - In order to debug the test file, select \"Mocha Current File\" option in VSCode  \n\n5. After the code is merged to master, create a Draft PR to test the new validation. Check both options, pass and failed.  \n    * (Draft PR marked as \"Work in Progress\" and cannot be merged, more info [here](https://help.github.com/en/articles/about-pull-requests#draft-pull-requests)).  \n    * Remember to delete the draft PR.  \n\n", "timestamp": "2025-10-21T22:03:53.811253"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Container Image Scan Vulnerability Assessment/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Container%20Image%20Scan%20Vulnerability%20Assessment/README.md", "content": "\n# Container Image Scan Vulnerability Assessment\n\n- Azure security center scan for container registry images for vulnerabilities and provide classified assessments with full remediation steps and analysis ([read more](https://docs.microsoft.com/en-us/azure/security-center/defender-for-container-registries-introduction)).\n\n- This folder provides useful tools to automate and enrich you work with the ASC image scan service and results.\n  Here your can find community developments and operations benefits ASC image scan feature or any useful tools in this regard. \n  Such as: Automation scripts to extract summary results, enrich you CI/CD with container image scan results and more.\n\n# Questions\nYou can submit any questions or requests [here](https://github.com/Azure/Azure-Security-Center/issues). Please also refer to our [Wiki](https://github.com/Azure/Azure-Security-Center/wiki#resources), as it will provide you with further information.\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n", "timestamp": "2025-10-21T22:03:56.308880"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Contributing.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Contributing.md", "content": "# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\n## How to contribute\n\nPlease note that this project is released with a [Contributor Code of Conduct](https://opensource.microsoft.com/codeofconduct/). By participating in this project you agree to abide by its terms.\n\n- [Contributing](#contributing)\n  - [How to contribute](#how-to-contribute)\n  - [Creating issues](#creating-issues)\n    - [Related repositories](#related-repositories)\n  - [Recommended setup for contributing](#recommended-setup-for-contributing)\n  - [Commit messages](#commit-messages)\n  - [Pull Requests](#pull-requests)\n\n## Creating issues\n\n- You can [create an issue][new-issue], but before doing that please read the bullets below and include as many details as possible. In case the issue is related to a bug, make sure to [add a reference](https://docs.github.com/en/github/managing-your-work-on-github/opening-an-issue-from-code) to the artifact.\n- Perform a [cursory search][issue-search] to see if a similar issue has already been submitted.\n- Make sure to use our [bug report][bug-report] or [feature request][feature-request] templates.\n\n### Related repositories\n\nThis is the repository for Microsoft Defender for Cloud. Please ensure that you are opening issues in the right repository. Other repos you might be looking for:\n\n- [Azure Monitor Community](https://github.com/microsoft/AzureMonitorCommunity#azure-monitor-community) repo, with query, alerts, workbook samples.\n- [Azure Monitor Workbook Templates](https://github.com/microsoft/Application-Insights-Workbooks) repo - contains workbook templates shown in the workbook galleries for Azure Monitor workbooks\n- [Log Analytics Query Examples](https://github.com/MicrosoftDocs/LogAnalyticsExamples) repo - contains example log analytics queries\n- [Azure Sentinel](https://github.com/azure/azure-sentinel) repo - contains queries, dashboards, templates used by Azure Sentinel\n\n## Recommended setup for contributing\n\n- To contribute your own examples, [fork the repo](https://help.github.com/articles/about-forks), [create a new branch](https://help.github.com/articles/about-branches), make your changes or additions, and then [submit a pull request](https://help.github.com/articles/about-pull-requests/).\n\n- If you submit a pull request, we'll add a comment to the pull request asking you to submit an online [CLA](https://cla.microsoft.com) (Contribution License Agreement). We'll need you to complete the online form before we can accept your pull request.\n\n- We do not allow adding new folders to the top level folder.\n\n## Commit messages\n\nWhen creating commits, always try to create useful commit messages explaining what that commit contains. Avoid commit messages like \"fix\" or \"commit\". If you're fixing something that's been reported as an issue in the repo, refer to the issue number in commit messages.\n\n## Pull Requests\n\nWhen creating a pull request, please create a good title, fill the description with content, and ideally, explain what your PR will change. Make sure to provide a [readme](https://github.com/Azure/Azure-Security-Center/wiki/Readme.md-Template) file so people will know what your artifact will do. Once your pull request is submitted, we will automatically verify you've signed the CLA agreement, and that your code passes a set of CI build tests.\n\n[code-of-conduct]: https://opensource.microsoft.com/codeofconduct/\n[new-issue]: https://github.com/Azure/Microsoft-Defender-for-Cloud/issues/new\n[bug-report]: https://github.com/Azure/Microsoft-Defender-for-Cloud/issues/new?assignees=&labels=&template=bug_report.md&title=\n[feature-request]: https://github.com/Azure/Microsoft-Defender-for-Cloud/issues/new?assignees=&labels=&template=feature_request.md&title=%5BFeature%20Request%5D%20%3Center%20your%20request%20title%3E\n[issue-search]: https://github.com/Azure/Microsoft-Defender-for-Cloud/issues\n", "timestamp": "2025-10-21T22:03:56.720446"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "DemoAutomation/readme.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/DemoAutomation/readme.md", "content": "# Simple Windows 2019 Server VM with RCE Vulnerabilities and Key Vault Demo Environment\n\nThis template allows you to deploy a simple Windows 2019 Server build version 2803, which includes RCE vulnerabilities out of the box (unless you run an update post install). This will deploy a D2s_v3 size VM in the resource group location and return the fully qualified domain name of the VM. To avoid updating the VM, it is configured with Manual Update only. Also, it deploys a Key Vault, a Managed System Identity assigned to the VM with permission to access the Key Vault, and Net Framework 4.8 for additional vulnerabilities.\n\n[![Deploy To Azure](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazure.svg?sanitize=true)](https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FMicrosoft-Defender-for-Cloud%2Fmain%2FDemoAutomation%2Fazuredeploy.json)\n\n\n\n## Note: for PoC only\n", "timestamp": "2025-10-21T22:03:57.361972"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Legacy Log Analytics dashboards/NotableEventsQueries.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Legacy%20Log%20Analytics%20dashboards/NotableEventsQueries.md", "content": "# Notable events queries\n\nThe following queries are used to populate the notable events dashboards.\nIn addition, the notable events dashboard queries are available under \"Saved searches\" in your workspace. They appear in 3 categories:\n\n- [Security Critical Notable Issues](#Security-Critical-Notable-Issues)\n- [Security Warning Notable Issues](#Security-Warning-Notable-Issues)\n- [Security Info Notable Issues](#Security-Info-Notable-Issues)\n\n## Security Critical Notable Issues\n\n### Computer with guest account logons\n\n`SecurityEvent\n| where EventID == 4624 and TargetUserName == 'Guest' and LogonType in (10, 3)\n| summarize count() by Computer`\n\n### Computers missing security updates\n\n`Update\n| where UpdateState == 'Needed' and Optional == false and Classification == 'Security Updates' and Approved != false\n| summarize count() by Computer`\n\n### Computers with detected threats\n\n`ProtectionStatus\n| summarize (TimeGenerated, ThreatStatusRank) = argmax(TimeGenerated, ThreatStatusRank) by Computer\n| where ThreatStatusRank > 199 and ThreatStatusRank != 470`\n\n### Distinct malicious IP addresses accessed\n\n`union isfuzzy=true (WireData\n| where Direction == 'Outbound'), (WindowsFirewall\n| where CommunicationDirection == 'SEND'), (CommonSecurityLog\n| where CommunicationDirection == 'Outbound')\n| where isnotempty(MaliciousIP)\n| summarize by MaliciousIP`\n\n### High priority Active Directory assessment security recommendations\n\n`let schemaColumns = datatable(TimeGenerated:datetime, RecommendationId:string)[];\nunion isfuzzy=true schemaColumns, (ADAssessmentRecommendation\n| where FocusArea == 'Security and Compliance' and RecommendationResult == 'Failed' and RecommendationScore>=35)\n| summarize arg_max(TimeGenerated, *) by RecommendationId`\n\n### High priority SQL assessment security recommendations\n\n`let schemaColumns = datatable(TimeGenerated:datetime, RecommendationId:string)[];\nunion isfuzzy=true schemaColumns, (SQLAssessmentRecommendation\n| where FocusArea == 'Security and Compliance' and RecommendationResult == 'Failed' and RecommendationScore>=35)\n| summarize arg_max(TimeGenerated, *) by RecommendationId`\n\n### Computers missing critical updates\n\n`Update\n| where UpdateState == 'Needed' and Optional == false and Classification == 'Critical Updates' and Approved != false\n| summarize count() by Computer`\n\n## Security Warning Notable Issues\n\n### Computers missing critical updates\n\n`Update\n| where UpdateState == 'Needed' and Optional == false and Classification == 'Critical Updates' and Approved != false\n| summarize count() by Computer`\n\n### Computers with insufficient protection\n\n`ProtectionStatus\n| summarize (TimeGenerated, ProtectionStatusRank) = argmax(TimeGenerated, ProtectionStatusRank) by Computer\n| where ProtectionStatusRank > 199 and ProtectionStatusRank != 550`\n\n### Computers with system audit policy changes\n\n`SecurityEvent\n| where EventID == 4719\n| summarize count() by Computer`\n\n### Domain security policy changes\n\n`SecurityEvent\n| where EventID == 4739\n| summarize count() by DomainPolicyChanged`\n\n### Logons with a clear text password\n\n`SecurityEvent\n| where EventID == 4624 and LogonType == 8\n| summarize count() by TargetAccount`\n\n### Low priority AD assessment security recommendations\n\n`let schemaColumns = datatable(TimeGenerated:datetime, RecommendationId:string)[];\nunion isfuzzy=true schemaColumns, (ADAssessmentRecommendation\n| where FocusArea == 'Security and Compliance' and RecommendationResult == 'Failed' and RecommendationScore<35)\n| summarize arg_max(TimeGenerated, *) by RecommendationId`\n\n### Low priority SQL assessment security recommendations\n\n`let schemaColumns = datatable(TimeGenerated:datetime, RecommendationId:string)[];\nunion isfuzzy=true schemaColumns, (SQLAssessmentRecommendation\n| where FocusArea == 'Security and Compliance' and RecommendationResult == 'Failed' and RecommendationScore<35)\n| summarize arg_max(TimeGenerated, *) by RecommendationId`\n\n### Members added To security-enabled groups\n\n`SecurityEvent\n| where EventID in (4728, 4732, 4756)\n| summarize count() by SubjectAccount`\n\n### Suspicious executables\n\n`SecurityEvent\n| where EventID == 8002 and Fqbn == '-'\n| summarize ExecutionCountHash=count() by FileHash\n| where ExecutionCountHash <= 5`\n\n## Security Info Notable Issues\n\n### Accounts failed to log on\n\n`SecurityEvent\n| where EventID == 4625\n| summarize count() by TargetAccount`\n\n### Accounts failed to login (Linux)\n\n`LinuxAuditLog\n| where RecordType == 'user_login' and res != 'success'\n| summarize count() by acct`\n\n### Change or reset passwords attempts\n\n`SecurityEvent\n| where EventID in (4723, 4724)\n| summarize count() by TargetAccount`\n\n### Computers with cleaned event logs\n\n`SecurityEvent\n| where EventID in (1102, 517) and EventSourceName == 'Microsoft-Windows-Eventlog'\n| summarize count() by Computer`\n\n### Computers with failed Linux user password change\n\n`Syslog\n| where Facility == 'authpriv' and ((SyslogMessage has 'passwd:chauthtok' and SyslogMessage has 'authentication failure') or SyslogMessage has 'password change failed')\n| summarize count() by Computer`\n\n### Computers with failed ssh logons\n\n`Syslog\n| where (Facility == 'authpriv' and SyslogMessage has 'sshd:auth' and SyslogMessage has 'authentication failure') or (Facility == 'auth' and ((SyslogMessage has 'Failed' and SyslogMessage has 'invalid user' and SyslogMessage has 'ssh2') or SyslogMessage has 'error: PAM: Authentication failure'))\n| summarize count() by Computer`\n\n### Computers with failed su logons\n\n`Syslog\n| where (Facility == 'authpriv' and SyslogMessage has 'su:auth' and SyslogMessage has 'authentication failure') or (Facility == 'auth' and SyslogMessage has 'FAILED SU')\n| summarize count() by Computer`\n\n### Computers with failed sudo logons\n\n`Syslog\n| where (Facility == 'authpriv' and SyslogMessage has 'sudo:auth' and (SyslogMessage has 'authentication failure' or SyslogMessage has 'conversation failed')) or ((Facility == 'auth' or Facility == 'authpriv') and SyslogMessage has 'user NOT in sudoers')\n| summarize count() by Computer`\n\n### Computers with new Linux group created\n\n`Syslog\n| where Facility == 'authpriv' and SyslogMessage has 'new group'\n| summarize count() by Computer`\n\n### Computers with users added to a Linux group\n\n`Syslog\n| where Facility == 'authpriv' and SyslogMessage has 'to group' and (SyslogMessage has 'add' or SyslogMessage has 'added')\n| summarize by Computer`\n\n### Distinct clients resolving malicious domains\n\n`let schemaColumns = datatable(ClientIP:string)[];\nunion isfuzzy=true schemaColumns, (DnsEvents\n| where SubType == 'LookupQuery' and isnotempty(MaliciousIP))\n| summarize count() by ClientIP`\n\n### Distinct paths of Executed Commands (Linux)\n\n`LinuxAuditLog\n| where RecordType == 'syscall' and syscall == 'execve'\n| summarize count() by exe`\n\n### Executed Commands (Linux)\n\n`LinuxAuditLog\n| where RecordType == 'syscall' and syscall == 'execve'\n| summarize count() by cmd`\n\n### Loading or Unloading of Kernel modules (Linux)\n\n`LinuxAuditLog\n| where key == 'kernelmodules' and RecordType != 'CONFIG_CHANGE'`\n\n### Locked accounts\n\n`SecurityEvent\n| where EventID == 4740\n| summarize count() by TargetAccount`\n\n### Remote procedure call(RPC) attempts\n\n`SecurityEvent\n| where EventID == 5712\n| summarize count() by Computer`\n\n### Security groups created or modified\n\n`SecurityEvent\n| where EventID in (4727, 4731, 4735, 4737, 4754, 4755)\n| summarize count() by TargetAccount`\n\n### User accounts created or enabled\n\n`SecurityEvent\n| where EventID in (4720, 4722)\n| summarize by TargetAccount`", "timestamp": "2025-10-21T22:03:59.034707"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Legacy Log Analytics dashboards/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Legacy%20Log%20Analytics%20dashboards/README.md", "content": "\n# Legacy Log Analytics dashboards\n\nIn July 31, 2019, Azure Security Center will retire 3 legacy Log Analytics' dashboards ([learn more](https://docs.microsoft.com/azure/security-center/security-center-features-retirement-july2019)).\n\nThe following files provide the Log Analytics' queries used to populate the retired dashboards, in case you'd like to reproduce the data visualized in these dashboards. You're encouraged to review the [retirement documentation](https://docs.microsoft.com/azure/security-center/security-center-features-retirement-july2019) to learn more on suggested alternatives.\n\n- [Identity and access dashboard](./IdentityDashboard.ts)\n- [Threat intelligence dashboard (Security events map)](./ThreatIntelligenceDashboard.ts)\n- [Security & audit dashboard](./SecurityAndAuditDashboard.ts)\n\nProvided files are in Typescript (.ts) format, which can be opened with any text editor. You can copy the applicable queries from these files to custom dashboards you'll create.\n\nIn addition, the notable events dashboard queries are available under \"Saved searches\" in your workspace. They appear in 3 categories:\n\n- Security Critical Notable Issues\n- Security Warning Notable Issues\n- Security Info Notable Issues\n\nYou can either copy the relevant queries from the \"Saved searches\" page in your workspace, or visit the [following](./NotableEventsQueries.md) page to view them.\n\n# Questions\nYou can submit any questions or requests [here](https://github.com/Azure/Azure-Security-Center/issues). Please also refer to our [Wiki](https://github.com/Azure/Azure-Security-Center/wiki#resources), as it will provide you with further information.\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n", "timestamp": "2025-10-21T22:03:59.138517"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Pricing & Settings/Continuous export/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Pricing%20&%20Settings/Continuous%20export/README.md", "content": "# Continuous Export\nThis folder contains samples for the Continuous Export feature.\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n", "timestamp": "2025-10-21T22:04:02.107042"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Pricing & Settings/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Pricing%20&%20Settings/README.md", "content": "# Pricing & Settings\nIn this section you can find code snippets for deploying Azure Security Center pricing & settings configurations programmatically and at scale.\n\n# Questions\nYou can submit any questions or requests [here](https://github.com/Azure/Azure-Security-Center/issues). Please also refer to our [Wiki](https://github.com/Azure/Azure-Security-Center/wiki#resources), as it will provide you with further information.\n\n# Azure Resource Graph queries \n\nIf you're interested in getting ASC pricing information via the Azure Resource Graph, please have a look at [these examples](https://github.com/Azure/Azure-Security-Center/tree/master/ARG%20queries/Starter%20Kit%20-%20ASC%20Pricing)\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n", "timestamp": "2025-10-21T22:04:02.356879"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/README.md", "content": "# Microsoft Defender for Cloud\r\n\r\n![GitHub](https://img.shields.io/github/license/azure/Microsoft-Defender-for-Cloud?label=License&style=plastic)\r\n![GitHub contributors](https://img.shields.io/github/contributors/azure/Microsoft-Defender-for-Cloud?label=Contributors&style=plastic)\r\n![GitHub last commit (branch)](https://img.shields.io/github/last-commit/azure/Microsoft-Defender-for-Cloud/main?label=Last%20commit&style=plastic)\r\n![GitHub commit activity](https://img.shields.io/github/commit-activity/m/azure/Microsoft-Defender-for-Cloud?label=Commit%20activity&style=plastic)\r\n![GitHub issues](https://img.shields.io/github/issues/azure/Microsoft-Defender-for-Cloud?label=Issues&style=plastic)\r\n\r\nWelcome to the Microsoft Defender for Cloud (formerly known as Azure Security Center) community repository. This repository contains:\r\n\r\n- Security recommendations that are in private preview\r\n- Programmatic remediation tools for security recommendations\r\n- PowerShell scripts for programmatic management\r\n- Azure Policy custom definitions for at-scale management of Microsoft Defender for Cloud\r\n- Logic App templates that work with Defender for Cloud's Logic App connectors (to automate response to Security alerts and recommendations)\r\n- Logic App templates that help you run regular tasks or reports within the scope of Microsoft Defender for Cloud\r\n- Custom workbooks to visualize Defender for Cloud data\r\n\r\nAll of the above will help you work programmatically at scale with Microsoft Defender for Cloud and provide you additional value to secure your environment, some of which has not yet been embedded into the product (yet). You can submit any questions or requests [here](https://github.com/Azure/Microsoft-Defender-for-Cloud/issues).\r\n\r\n## What's new?\r\nPlease find the latest and greatest automations on our [What's New Page](https://github.com/Azure/Microsoft-Defender-for-Cloud/wiki/What's-New).\r\n\r\n## Support\r\n\r\nAll automations within this repository are provided as is, without SLA or official support. However, if you have an issue please fill out a [bug report](https://github.com/Azure/Microsoft-Defender-for-Cloud/issues/new?assignees=&labels=&template=bug_report.md&title=) and reference the automation artifact, so the community can try to solve it.\r\n\r\n## Wiki\r\n\r\nThis project has its own [Wiki](https://github.com/Azure/Microsoft-Defender-for-Cloud/wiki) which will provide you with further information about the Microsoft Defender for Cloud community, how to contribute, templates to use, and further resources.\r\n\r\n## Additional resources\r\n\r\nPlease visit the following additional resources to learn more about Microsoft Defender for Cloud and participate in discussions:\r\n\r\n- [Microsoft Defender for Cloud Forum](https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/bd-p/MicrosoftDefenderCloud)\r\n- [Microsoft Defender for Cloud Blog](https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/bg-p/MicrosoftDefenderCloudBlog)\r\n- [Microsoft Defender for Cloud Feature suggestion](https://feedback.azure.com/d365community/forum/0f853254-0425-ec11-b6e6-000d3a4f07b8)\r\n- [Microsoft Defender for Cloud documentation](https://docs.microsoft.com/en-us/azure/security-center/defender-for-cloud-introduction)\r\n- [Microsoft Defender for Cloud API documentation](https://docs.microsoft.com/en-us/rest/api/securitycenter/)\r\n\r\n## Contributing\r\n\r\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.microsoft.com.\r\n\r\nAnyone can contribute to this repo, you don't need to be a pro. You have an interesting Logic App, Policy, or other automation artifact? Then fork this repo, add your content to your fork and submit a pull request.\r\n\r\nTo make sure your contribution aligns with our [Contribution Guideline](./Contributing.md), please make sure to review it before submitting.\r\n\r\n### Pull Request\r\n\r\n- After you push your changes, you will need to submit the [Pull Request (PR)](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests).\r\n- After submission, check the [Pull Request](https://github.com/Azure/Microsoft-Defender-for-Cloud/pulls) for comments.\r\n- Make changes as suggested and update your branch or explain why no change is needed. Resolve the comment when done.\r\n\r\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA.\r\n\r\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\r\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\r\n", "timestamp": "2025-10-21T22:04:02.777908"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "SECURITY.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/SECURITY.md", "content": "<!-- BEGIN MICROSOFT SECURITY.MD V0.0.7 BLOCK -->\n\n## Security\n\nMicrosoft takes the security of our software products and services seriously, which includes all source code repositories managed through our GitHub organizations, which include [Microsoft](https://github.com/Microsoft), [Azure](https://github.com/Azure), [DotNet](https://github.com/dotnet), [AspNet](https://github.com/aspnet), [Xamarin](https://github.com/xamarin), and [our GitHub organizations](https://opensource.microsoft.com/).\n\nIf you believe you have found a security vulnerability in any Microsoft-owned repository that meets [Microsoft's definition of a security vulnerability](https://aka.ms/opensource/security/definition), please report it to us as described below.\n\n## Reporting Security Issues\n\n**Please do not report security vulnerabilities through public GitHub issues.**\n\nInstead, please report them to the Microsoft Security Response Center (MSRC) at [https://msrc.microsoft.com/create-report](https://aka.ms/opensource/security/create-report).\n\nIf you prefer to submit without logging in, send email to [secure@microsoft.com](mailto:secure@microsoft.com).  If possible, encrypt your message with our PGP key; please download it from the [Microsoft Security Response Center PGP Key page](https://aka.ms/opensource/security/pgpkey).\n\nYou should receive a response within 24 hours. If for some reason you do not, please follow up via email to ensure we received your original message. Additional information can be found at [microsoft.com/msrc](https://aka.ms/opensource/security/msrc). \n\nPlease include the requested information listed below (as much as you can provide) to help us better understand the nature and scope of the possible issue:\n\n  * Type of issue (e.g. buffer overflow, SQL injection, cross-site scripting, etc.)\n  * Full paths of source file(s) related to the manifestation of the issue\n  * The location of the affected source code (tag/branch/commit or direct URL)\n  * Any special configuration required to reproduce the issue\n  * Step-by-step instructions to reproduce the issue\n  * Proof-of-concept or exploit code (if possible)\n  * Impact of the issue, including how an attacker might exploit the issue\n\nThis information will help us triage your report more quickly.\n\nIf you are reporting for a bug bounty, more complete reports can contribute to a higher bounty award. Please visit our [Microsoft Bug Bounty Program](https://aka.ms/opensource/security/bounty) page for more details about our active programs.\n\n## Preferred Languages\n\nWe prefer all communications to be in English.\n\n## Policy\n\nMicrosoft follows the principle of [Coordinated Vulnerability Disclosure](https://aka.ms/opensource/security/cvd).\n\n<!-- END MICROSOFT SECURITY.MD BLOCK -->\n", "timestamp": "2025-10-21T22:04:03.926359"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Security Recommendations/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Security%20Recommendations/README.md", "content": "# Security recommendations\nIn this section you can find custom security recommendations you can onboard to Azure Security Center. ([Learn more about custom recommendations in Azure Security Center](https://docs.microsoft.com/en-us/azure/security-center/custom-security-policies))\n\n# Questions\nYou can submit any questions or requests [here](https://github.com/Azure/Azure-Security-Center/issues). Please also refer to our [Wiki](https://github.com/Azure/Azure-Security-Center/wiki#resources), as it will provide you with further information.\n\n# Contributing\n\nThis project welcomes contributions and suggestions.  Most contributions require you to agree to a\nContributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us\nthe rights to use your contribution. For details, visit https://cla.microsoft.com.\n\nWhen you submit a pull request, a CLA-bot will automatically determine whether you need to provide\na CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions\nprovided by the bot. You will only need to do this once across all repos using our CLA.\n\nThis project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).\nFor more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or\ncontact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.\n", "timestamp": "2025-10-21T22:04:05.221080"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Workbooks/Azure Defender Active Alerts/readme.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Workbooks/Azure%20Defender%20Active%20Alerts/readme.md", "content": "# Microsoft Defender Active Alerts Workbook\n**Author: Safeena Begum**\n\n## Playbook Description: \nSecurity Alerts are the notifications that Microsoft Defender for Cloud generates when it detects threats on your resources. Microsoft Defender for Cloud prioritizes and lists the alerts, along with information needed for you to quickly investigate the problem. Microsoft Defender for Cloud also provides detailed steps to help you remediate attacks. Alerts data is retained for 90 days. Here is the list of resource types that Microsoft Defender secures. Make sure to visit this article that lists the security alerts you might get from Microsoft Defender for Cloud and any Microsoft Defender plans you’ve enabled. \n\nMicrosoft Defender for Cloud allows you to create custom workbooks across your data, and also comes with built-in workbook templates to allow you to quickly gain insights across your data as soon as you connect a data source. For example, with Secure Score Over Time report, you can track your organization’s security posture. Read more about how workbooks provide rich set of functionalities in our Azure monitor documentation and to understand workbooks gallery in Microsoft Defender for Cloud, make sure to review our documentation. \n\nWith this automation, I’m introducing you to another great template that provides representation of your active alerts in different pivots that would help you understand the overall threats on your environment and prioritize between them. \n\nPre-requisites: Most of the workbook uses Azure Resource Graph to query the data. At some places (to display Map View) it uses Log Analytics workspace to query the data. So, make sure you have continuous export turned on and exporting the Security Alerts to the Log Analytics workspace \n\nYou can deploy the main template by clicking the button below:\n\n***\n\nTo deploy main template:\n\n<a href=\"https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Security-Center%2Fmain%2FWorkbooks%2FAzure%20Defender%20Active%20Alerts%2FAzureDefenderActiveAlerts.json\" target=\"_blank\">\n    <img src=\"https://aka.ms/deploytoazurebutton\"/>\n</a>\n<a href=\"https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2FAzure%2FAzure-Security-Center%2Fmain%2FWorkbooks%2FAzure%20Defender%20Active%20Alerts%2FAzureDefenderActiveAlerts.json\" target=\"_blank\">\n<img src=\"https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/1-CONTRIBUTION-GUIDE/images/deploytoazuregov.png\"/>\n</a> \n\n***\n\n## NOTE: \nTo get the best experience, make sure you have your browser zoom settings set to 75% or 80%\n", "timestamp": "2025-10-21T22:04:07.417681"}
{"source": "github", "repo": "Azure/Azure-Security-Center", "file": "Workbooks/README.md", "url": "https://github.com/Azure/Microsoft-Defender-for-Cloud/blob/main/Workbooks/README.md", "content": "# Azure  Workbooks for Microsoft Defender for Cloud\n\n![GitHub](https://img.shields.io/github/license/azure/Microsoft-Defender-for-Cloud?label=License&style=plastic)\n\nThis project contains **Azure Workbook templates** you can use to create custom dashboards within Microsoft Defender for Cloud. The workbooks can be deployed as ARM templates to your Defender for Cloud environment.\n\n## Contributing\n\nAnyone can contribute, you don't need to be a pro. You have an interesting query or workbook? Then fork this repo, add your content to your fork and submit a pull request. See our [Contribution Guideline](../Contributing.md) for more details.\n\nIn addition to the overall contribution guideline, please make sure to adhere to the following aspects when submitting a new workbook:\n\n1. Add a **screenshot** of the workbook\n2. Ensure all steps have **meaningful names**\n3. Ensure all parameters and grid columns have **display names** set so they can be localized\n4. Ensure that parameters id values are **unique**\n5. Ensure that steps names are **unique**\n6. Grep /subscription/ and ensure that your parameters don't have **any hardcoded resourceIds**\n7. Add the fromTemplateId property to the workbook's gallery template and include your workbook name. for example: Network Security Dashboard should be: ```\"fromTemplateId\": \"NetworkSecurityDashboard\"```.\n\n\n\n## How to create a .workbook file\n\nThere are three ways of creating a template:\n\n- Create a new template based on an empty workbook.\n- Create a new template based on an existing template. You can modify or enhance the existing template.\n- Create a new template from an existing report. You can modify or enhance the existing report.\n\n### Create from an empty workbook\n\n1. Go to http://portal.azure.com \n2. Select Microsoft Defender for Cloud from the navigation menu\n3. Select \"Workbooks\"\n4. Select the Empty workbook in the Quick Start section.\n    ![Image of default template](./Images//emptyTemplate.png)\n5. Modify report as you wish and click \"Advanced Editor\" button from the menu. \n    ![Image of toolbar](./Images/toolbar-advancedEditor.png)\n6. Use the download button or copy all contents and create a file like `your custom template name.workbook`. \n   Make sure the file name ends with `.workbook` and avoid using any special characters (like `/\\&?`) in your file name.\n    ![advanced editor](./Images/advancedEditor.png)\n\n### Create from an existing template\n\n1. Go to http://portal.azure.com \n2. Select Microsoft Defender for Cloud from the navigation bar.\n3. Select \"Workbooks\"\n4. Select a template you are interested in editing.\n5. Modify as you wish and click \"Advanced Editor\" button from the menu.\n6. Use the download button, or copy contents and create a file like `your custom template name.workbook`.\n   Make sure the file name ends with `.workbook` and avoid using any special characters (like `/\\&?`) in your file name.\n\n### Create from a saved workbook\n\n1. Go to http://portal.azure.com \n2. Select Microsoft Defender for Cloud from the navigation bar.\n3. Select \"Workbooks\"\n4. Click on the Open icon from the menu.\n   ![Image of the toolbar](./Images/openWorkbook.png)\n5. Select a desired saved workbook you want to start with.\n6. Modify the workbook as you wish and click the \"Advanced Editor\" button from the menu.\n7. Use the download button, or copy contents and create a file like `your custom template name.workbook`. Make sure the file name ends with `.workbook` and avoid using any special characters (like `/\\&?`) in your file name.\n", "timestamp": "2025-10-21T22:04:09.003994"}
